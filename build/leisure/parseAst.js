"use strict";
define([], function(){
  return L_runMonads([
    function(){return resolve(L_newDefine)("makeNode", 5, "makeNode svg width height rootX rootY = \\f . f svg width height rootX rootY", lazy(setDataType((function(){
  var L_$F = function(L_svg, L_width, L_height, L_rootX, L_rootY) {
    return L_checkPartial(L_$F, arguments) || setType((function(){
  var L_$F = (function(L_f){return resolve(L_f)(L_svg)(L_width)(L_height)(L_rootX)(L_rootY)});
  L_$F.leisureFunctionId = 78;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})(), 'makeNode');
  };
  L_$F.leisureFunctionId = 79;
  L_$F.leisureLength = 5;
  return L_$F;
})(), 'makeNode')))},
    function(){return resolve(L_newDefine)("nodeSvg", 1, "nodeSvg st = st \\svg width height rootX rootY . svg", lazy((function(){
  var L_$F = (function(L_st){return resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_svg)});
  L_$F.leisureFunctionId = 85;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 84;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 83;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 82;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 81;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 80;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeWidth", 1, "nodeWidth st = st \\svg width height rootX rootY . width", lazy((function(){
  var L_$F = (function(L_st){return resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_width)});
  L_$F.leisureFunctionId = 91;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 90;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 89;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 88;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 87;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 86;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeHeight", 1, "nodeHeight st = st \\svg width height rootX rootY . height", lazy((function(){
  var L_$F = (function(L_st){return resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_height)});
  L_$F.leisureFunctionId = 97;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 96;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 95;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 94;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 93;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 92;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeRootX", 1, "nodeRootX st = st \\svg width height rootX rootY . rootX", lazy((function(){
  var L_$F = (function(L_st){return resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_rootX)});
  L_$F.leisureFunctionId = 103;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 102;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 101;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 100;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 99;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 98;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeRootY", 1, "nodeRootY st = st \\svg width height rootX rootY . rootY", lazy((function(){
  var L_$F = (function(L_st){return resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_rootY)});
  L_$F.leisureFunctionId = 109;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 108;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 107;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 106;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 105;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 104;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("space", 0, "space = 10", 10)},
    function(){return resolve(L_newDefine)("border", 0, "border = 5", 5)},
    function(){return resolve(L_newDefine)("nodeTranslate", 3, "nodeTranslate st x y = st \\svg width height rootX rootY . makeNode\r\n  translate svg x y\r\n  width\r\n  height\r\n  rootX + x\r\n  rootY + y", lazy((function(){
  var L_$F = function(L_st, L_x, L_y) {
    return L_checkPartial(L_$F, arguments) || resolve(L_st)(lazy((function(){
  var L_$F = (function(L_svg){return (function(){
  var L_$F = (function(L_width){return (function(){
  var L_$F = (function(L_height){return (function(){
  var L_$F = (function(L_rootX){return (function(){
  var L_$F = (function(L_rootY){return resolve(L_makeNode)(function(){return resolve(L_translate)(L_svg, L_x, L_y);}, L_width, L_height, function(){return resolve(L_$o)(L_rootX, L_x);}, function(){return resolve(L_$o)(L_rootY, L_y);})});
  L_$F.leisureFunctionId = 114;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 113;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 112;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 111;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 110;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));
  };
  L_$F.leisureFunctionId = 115;
  L_$F.leisureLength = 3;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeLine", 2, "nodeLine n1 n2 = n1 \\s1 w1 h1 x1 y1 . n2 \\s2 w2 h2 x2 y2 .\r\n  line [['x1'|x1] ['y1'|y1] ['x2'|x2] ['y2'|y2] ['stroke-width'|3] | defaultLineMap]", lazy((function(){
  var L_$F = function(L_n1, L_n2) {
    return L_checkPartial(L_$F, arguments) || resolve(L_n1)(lazy((function(){
  var L_$F = (function(L_s1){return (function(){
  var L_$F = (function(L_w1){return (function(){
  var L_$F = (function(L_h1){return (function(){
  var L_$F = (function(L_x1){return (function(){
  var L_$F = (function(L_y1){return resolve(L_n2)(lazy((function(){
  var L_$F = (function(L_s2){return (function(){
  var L_$F = (function(L_w2){return (function(){
  var L_$F = (function(L_h2){return (function(){
  var L_$F = (function(L_x2){return (function(){
  var L_$F = (function(L_y2){return resolve(L_line)(function(){return resolve(L_cons)(function(){return resolve(L_cons)("x1", L_x1);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("y1", L_y1);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("x2", L_x2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("y2", L_y2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke-width", 3);}, L_defaultLineMap);});});});});})});
  L_$F.leisureFunctionId = 125;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 124;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 123;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 122;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 121;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 120;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 119;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 118;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 117;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 116;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));
  };
  L_$F.leisureFunctionId = 126;
  L_$F.leisureLength = 2;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("rangeContainsRange", 4, "rangeContainsRange start end innerStart innerEnd = and (lte start innerStart) (lte innerEnd end)", lazy((function(){
  var L_$F = function(L_start, L_end, L_innerStart, L_innerEnd) {
    return L_checkPartial(L_$F, arguments) || resolve(L_and)(function(){return L$(resolve(L_lte))(L_start, L_innerStart);}, function(){return L$(resolve(L_lte))(L_innerEnd, L_end);});
  };
  L_$F.leisureFunctionId = 127;
  L_$F.leisureLength = 4;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("highlight", 1, "highlight map = do\r\n  c = assocGetWithDefault 'fill' map nil\r\n  eq c '#fcc'\r\n    assocSet 'fill' 'red' map\r\n    eq c '#cfc'\r\n      assocSet 'fill' 'green' map\r\n      eq c '#ccf'\r\n        assocSet 'fill' 'blue' map\r\n        map", lazy((function(){
  var L_$F = (function(L_map){return (function(){  var L_c_0;
  L_c_0 = function(){return resolve(L_assocGetWithDefault)("fill", L_map, L_nil);};

  return resolve(L_eq)(L_c_0, "#fcc")(function(){return L$(resolve(L_assocSet))("fill", "red", L_map);})(function(){return resolve(L_eq)(L_c_0, "#cfc")(function(){return L$(resolve(L_assocSet))("fill", "green", L_map);})(function(){return resolve(L_eq)(L_c_0, "#ccf")(function(){return L$(resolve(L_assocSet))("fill", "blue", L_map);})(L_map);});})})()});
  L_$F.leisureFunctionId = 128;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("treeFor", 1, "treeFor ast = treeForWith ast \\ast map . map", lazy((function(){
  var L_$F = (function(L_ast){return resolve(L_treeForWith)(L_ast, lazy((function(){
  var L_$F = (function(L_ast_0){return (function(){
  var L_$F = (function(L_map){return resolve(L_map)});
  L_$F.leisureFunctionId = 131;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 130;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))});
  L_$F.leisureFunctionId = 129;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("treeForWith", 2, "treeForWith ast mapFunc = nodeSvg (nodeFor ast mapFunc)", lazy((function(){
  var L_$F = function(L_ast, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || resolve(L_nodeSvg)(function(){return resolve(L_nodeFor)(L_ast, L_mapFunc);});
  };
  L_$F.leisureFunctionId = 132;
  L_$F.leisureLength = 2;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("wrappedTreeFor", 1, "wrappedTreeFor ast = do\r\n  content = nodeFor ast \\ast map . map\r\n  svg (nodeSvg content) {'width':(border + (nodeWidth content)) 'height':(border + (nodeHeight content))}", lazy((function(){
  var L_$F = (function(L_ast){return (function(){  var L_content_0;
  L_content_0 = function(){return resolve(L_nodeFor)(L_ast, lazy((function(){
  var L_$F = (function(L_ast_0){return (function(){
  var L_$F = (function(L_map){return resolve(L_map)});
  L_$F.leisureFunctionId = 135;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 134;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));};

  return resolve(L_svg)(function(){return resolve(L_nodeSvg)(L_content_0);}, function(){return resolve(L_aconsPair)(function(){return resolve(L_cons)("width", function(){return resolve(L_$o)(L_border, function(){return resolve(L_nodeWidth)(L_content_0);});});}, function(){return resolve(L_aconsPair)(function(){return resolve(L_cons)("height", function(){return resolve(L_$o)(L_border, function(){return resolve(L_nodeHeight)(L_content_0);});});}, L_nil);});})})()});
  L_$F.leisureFunctionId = 133;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("nodeFor", 2, "nodeFor ast mapFunc = do\r\n  t = getType ast\r\n  eq t 'lit'\r\n    createLitNode ast (show (ast \\v p . v)) mapFunc\r\n    eq t 'ref'\r\n      createRefNode ast (show (ast \\n p . n)) mapFunc\r\n      eq t 'lambda'\r\n        ast (\\v b p . createLambdaNode ast v b mapFunc)\r\n        eq t 'apply'\r\n          ast (\\f a . createApplyNode ast f a mapFunc)\r\n          eq t 'anno'\r\n            #ast (\\n d b . createApplyNode ast f a mapFunc)\r\n            ast (\\n d b . nodeFor b mapFunc)\r\n            log 2 makeNode (svgNode '') 0 0 0 0", lazy((function(){
  var L_$F = function(L_ast, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || (function(){  var L_t_0;
  L_t_0 = function(){return resolve(L_getType)(L_ast);};

  return resolve(L_eq)(L_t_0, "lit")(function(){return resolve(L_createLitNode)(L_ast, function(){return resolve(L_show)(function(){return resolve(L_ast)(lazy((function(){
  var L_$F = (function(L_v){return (function(){
  var L_$F = (function(L_p){return resolve(L_v)});
  L_$F.leisureFunctionId = 137;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 136;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));});}, L_mapFunc);})(function(){return resolve(L_eq)(L_t_0, "ref")(function(){return resolve(L_createRefNode)(L_ast, function(){return resolve(L_show)(function(){return resolve(L_ast)(lazy((function(){
  var L_$F = (function(L_n){return (function(){
  var L_$F = (function(L_p){return resolve(L_n)});
  L_$F.leisureFunctionId = 139;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 138;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));});}, L_mapFunc);})(function(){return resolve(L_eq)(L_t_0, "lambda")(function(){return resolve(L_ast)(lazy((function(){
  var L_$F = (function(L_v){return (function(){
  var L_$F = (function(L_b){return (function(){
  var L_$F = (function(L_p){return resolve(L_createLambdaNode)(L_ast, L_v, L_b, L_mapFunc)});
  L_$F.leisureFunctionId = 142;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 141;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 140;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));})(function(){return resolve(L_eq)(L_t_0, "apply")(function(){return resolve(L_ast)(lazy((function(){
  var L_$F = (function(L_f){return (function(){
  var L_$F = (function(L_a){return resolve(L_createApplyNode)(L_ast, L_f, L_a, L_mapFunc)});
  L_$F.leisureFunctionId = 144;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 143;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));})(function(){return resolve(L_eq)(L_t_0, "anno")(function(){return resolve(L_ast)(lazy((function(){
  var L_$F = (function(L_n){return (function(){
  var L_$F = (function(L_d){return (function(){
  var L_$F = (function(L_b){return resolve(L_nodeFor)(L_b, L_mapFunc)});
  L_$F.leisureFunctionId = 147;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 146;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 145;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));})(function(){return resolve(L_log)(2, L_makeNode)(function(){return resolve(L_svgNode)("");})(0)(0)(0)(0);});});});});})})();
  };
  L_$F.leisureFunctionId = 148;
  L_$F.leisureLength = 2;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("redStyle", 0, "redStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#fcc'] ['rx'|8] ['ry'|8]]", function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke", "black");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke-width", 2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("fill", "#fcc");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("rx", 8);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("ry", 8);}, L_nil);});});});});})},
    function(){return resolve(L_newDefine)("greenStyle", 0, "greenStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#cfc'] ['rx'|8] ['ry'|8]]", function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke", "black");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke-width", 2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("fill", "#cfc");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("rx", 8);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("ry", 8);}, L_nil);});});});});})},
    function(){return resolve(L_newDefine)("blueStyle", 0, "blueStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#ccf'] ['rx'|8] ['ry'|8]]", function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke", "black");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("stroke-width", 2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("fill", "#ccf");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("rx", 8);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("ry", 8);}, L_nil);});});});});})},
    function(){return resolve(L_newDefine)("createLambdaNode", 4, "createLambdaNode ast v b mapFunc = do\r\n  rootBox = textNode (mapFunc ast greenStyle) 'lambda'\r\n  varBox = textNode (mapFunc ast greenStyle) v\r\n  bodyTree = nodeFor b mapFunc\r\n  childWidth = (nodeWidth varBox) + space + (nodeWidth bodyTree)\r\n  totalWidth = max childWidth (nodeWidth rootBox)\r\n  pad = max 0 (totalWidth - childWidth) / 2\r\n  rootBox = nodeTranslate rootBox (totalWidth / 2 - (nodeWidth rootBox) / 2) 0\r\n  varBox = nodeTranslate varBox pad (nodeHeight rootBox) + space\r\n  bodyTree = nodeTranslate bodyTree (pad + (nodeWidth varBox) + space) ((nodeHeight rootBox) + space)\r\n  log 3 makeNode\r\n    svgConcat [(nodeLine rootBox varBox) (nodeLine rootBox bodyTree) (nodeSvg varBox) (nodeSvg bodyTree) (nodeSvg rootBox)]\r\n    totalWidth\r\n    (nodeHeight rootBox) + space + (max (nodeHeight varBox) (nodeHeight bodyTree))\r\n    totalWidth / 2\r\n    (nodeHeight rootBox) / 2", lazy((function(){
  var L_$F = function(L_ast, L_v, L_b, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || (function(){  var L_rootBox_0, L_varBox_1, L_bodyTree_2, L_childWidth_3, L_totalWidth_4, L_pad_5, L_rootBox_6, L_varBox_7, L_bodyTree_8;
  L_rootBox_0 = function(){return resolve(L_textNode)(function(){return L$(resolve(L_mapFunc))(L_ast, L_greenStyle);}, "lambda");};
  L_varBox_1 = function(){return resolve(L_textNode)(function(){return L$(resolve(L_mapFunc))(L_ast, L_greenStyle);}, L_v);};
  L_bodyTree_2 = function(){return resolve(L_nodeFor)(L_b, L_mapFunc);};
  L_childWidth_3 = function(){return resolve(L_$o)(function(){return resolve(L_$o)(function(){return resolve(L_nodeWidth)(L_varBox_1);}, L_space);}, function(){return resolve(L_nodeWidth)(L_bodyTree_2);});};
  L_totalWidth_4 = function(){return resolve(L_max)(L_childWidth_3, function(){return resolve(L_nodeWidth)(L_rootBox_0);});};
  L_pad_5 = function(){return resolve(L_max)(0, function(){return resolve(L_$f)(function(){return resolve(L_$_)(L_totalWidth_4, L_childWidth_3);}, 2);});};
  L_rootBox_6 = function(){return resolve(L_nodeTranslate)(L_rootBox_0, function(){return resolve(L_$_)(function(){return resolve(L_$f)(L_totalWidth_4, 2);}, function(){return resolve(L_$f)(function(){return resolve(L_nodeWidth)(L_rootBox_0);}, 2);});}, 0);};
  L_varBox_7 = function(){return resolve(L_nodeTranslate)(L_varBox_1, L_pad_5, function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);});};
  L_bodyTree_8 = function(){return resolve(L_nodeTranslate)(L_bodyTree_2, function(){return resolve(L_$o)(function(){return resolve(L_$o)(L_pad_5, function(){return resolve(L_nodeWidth)(L_varBox_7);});}, L_space);}, function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);});};

  return resolve(L_log)(3, L_makeNode)(function(){return resolve(L_svgConcat)(function(){return resolve(L_cons)(function(){return resolve(L_nodeLine)(L_rootBox_6, L_varBox_7);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeLine)(L_rootBox_6, L_bodyTree_8);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_varBox_7);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_bodyTree_8);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_rootBox_6);}, L_nil);});});});});});})(L_totalWidth_4)(function(){return resolve(L_$o)(function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);}, function(){return resolve(L_max)(function(){return resolve(L_nodeHeight)(L_varBox_7);}, function(){return resolve(L_nodeHeight)(L_bodyTree_8);});});})(function(){return resolve(L_$f)(L_totalWidth_4, 2);})(function(){return resolve(L_$f)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, 2);})})();
  };
  L_$F.leisureFunctionId = 149;
  L_$F.leisureLength = 4;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("createApplyNode", 4, "createApplyNode ast f a mapFunc = do\r\n  rootBox = textNode (mapFunc ast blueStyle) 'apply'\r\n  funcTree = nodeFor f mapFunc\r\n  argTree = nodeFor a mapFunc\r\n  childWidth = (nodeWidth argTree) + space + (nodeWidth funcTree)\r\n  totalWidth = max childWidth (nodeWidth rootBox)\r\n  pad = max 0 (totalWidth - childWidth) / 2\r\n  rootBox = nodeTranslate rootBox (totalWidth / 2 - (nodeWidth rootBox) / 2) 0\r\n  funcTree = nodeTranslate funcTree pad (nodeHeight rootBox) + space\r\n  argTree = nodeTranslate argTree (pad + (nodeWidth funcTree) + space) ((nodeHeight rootBox) + space)\r\n  makeNode\r\n    svgConcat [(nodeLine rootBox funcTree) (nodeLine rootBox argTree) (nodeSvg rootBox) (nodeSvg funcTree) (nodeSvg argTree)]\r\n    totalWidth\r\n    (nodeHeight rootBox) + space + (max (nodeHeight argTree) (nodeHeight funcTree))\r\n    totalWidth / 2\r\n    (nodeHeight rootBox) / 2", lazy((function(){
  var L_$F = function(L_ast, L_f, L_a, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || (function(){  var L_rootBox_0, L_funcTree_1, L_argTree_2, L_childWidth_3, L_totalWidth_4, L_pad_5, L_rootBox_6, L_funcTree_7, L_argTree_8;
  L_rootBox_0 = function(){return resolve(L_textNode)(function(){return L$(resolve(L_mapFunc))(L_ast, L_blueStyle);}, "apply");};
  L_funcTree_1 = function(){return resolve(L_nodeFor)(L_f, L_mapFunc);};
  L_argTree_2 = function(){return resolve(L_nodeFor)(L_a, L_mapFunc);};
  L_childWidth_3 = function(){return resolve(L_$o)(function(){return resolve(L_$o)(function(){return resolve(L_nodeWidth)(L_argTree_2);}, L_space);}, function(){return resolve(L_nodeWidth)(L_funcTree_1);});};
  L_totalWidth_4 = function(){return resolve(L_max)(L_childWidth_3, function(){return resolve(L_nodeWidth)(L_rootBox_0);});};
  L_pad_5 = function(){return resolve(L_max)(0, function(){return resolve(L_$f)(function(){return resolve(L_$_)(L_totalWidth_4, L_childWidth_3);}, 2);});};
  L_rootBox_6 = function(){return resolve(L_nodeTranslate)(L_rootBox_0, function(){return resolve(L_$_)(function(){return resolve(L_$f)(L_totalWidth_4, 2);}, function(){return resolve(L_$f)(function(){return resolve(L_nodeWidth)(L_rootBox_0);}, 2);});}, 0);};
  L_funcTree_7 = function(){return resolve(L_nodeTranslate)(L_funcTree_1, L_pad_5, function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);});};
  L_argTree_8 = function(){return resolve(L_nodeTranslate)(L_argTree_2, function(){return resolve(L_$o)(function(){return resolve(L_$o)(L_pad_5, function(){return resolve(L_nodeWidth)(L_funcTree_7);});}, L_space);}, function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);});};

  return resolve(L_makeNode)(function(){return resolve(L_svgConcat)(function(){return resolve(L_cons)(function(){return resolve(L_nodeLine)(L_rootBox_6, L_funcTree_7);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeLine)(L_rootBox_6, L_argTree_8);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_rootBox_6);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_funcTree_7);}, function(){return resolve(L_cons)(function(){return resolve(L_nodeSvg)(L_argTree_8);}, L_nil);});});});});});}, L_totalWidth_4, function(){return resolve(L_$o)(function(){return resolve(L_$o)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, L_space);}, function(){return resolve(L_max)(function(){return resolve(L_nodeHeight)(L_argTree_8);}, function(){return resolve(L_nodeHeight)(L_funcTree_7);});});}, function(){return resolve(L_$f)(L_totalWidth_4, 2);}, function(){return resolve(L_$f)(function(){return resolve(L_nodeHeight)(L_rootBox_6);}, 2);})})();
  };
  L_$F.leisureFunctionId = 150;
  L_$F.leisureLength = 4;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("createRefNode", 3, "createRefNode ast ref mapFunc = textNode (mapFunc ast redStyle) ref", lazy((function(){
  var L_$F = function(L_ast, L_ref, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || resolve(L_textNode)(function(){return L$(resolve(L_mapFunc))(L_ast, L_redStyle);}, L_ref);
  };
  L_$F.leisureFunctionId = 151;
  L_$F.leisureLength = 3;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("createLitNode", 3, "createLitNode ast lit mapFunc = textNode (mapFunc ast greenStyle) lit", lazy((function(){
  var L_$F = function(L_ast, L_lit, L_mapFunc) {
    return L_checkPartial(L_$F, arguments) || resolve(L_textNode)(function(){return L$(resolve(L_mapFunc))(L_ast, L_greenStyle);}, L_lit);
  };
  L_$F.leisureFunctionId = 152;
  L_$F.leisureLength = 3;
  return L_$F;
})()))},
    function(){return resolve(L_newDefine)("textNode", 2, "textNode map txt = (svgMeasureText txt '') \\w h . do\r\n  nodeW = w + 24\r\n  nodeH = h + 14\r\n  makeNode\r\n    (svgConcat [(rect [['x'|2] ['y'|2] ['width'|nodeW] ['height'|nodeH] | map]) (text txt [['pointer-events' | 'none'] ['text-anchor'|\"middle\"] ['dominant-baseline'|\"mathematical\"] ['x'| 14 + w / 2] ['y'| border + h / 2] ['font-weight'|'bold']])])\r\n    nodeW\r\n    nodeH\r\n    nodeW / 2\r\n    nodeH / 2", lazy((function(){
  var L_$F = function(L_map, L_txt) {
    return L_checkPartial(L_$F, arguments) || L$(resolve(L_svgMeasureText))(L_txt, "", lazy((function(){
  var L_$F = (function(L_w){return (function(){
  var L_$F = (function(L_h){return (function(){  var L_nodeW_0, L_nodeH_1;
  L_nodeW_0 = function(){return resolve(L_$o)(L_w, 24);};
  L_nodeH_1 = function(){return resolve(L_$o)(L_h, 14);};

  return resolve(L_makeNode)(function(){return resolve(L_svgConcat)(function(){return resolve(L_cons)(function(){return resolve(L_rect)(function(){return resolve(L_cons)(function(){return resolve(L_cons)("x", 2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("y", 2);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("width", L_nodeW_0);}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("height", L_nodeH_1);}, L_map);});});});});}, function(){return resolve(L_cons)(function(){return resolve(L_text)(L_txt, function(){return resolve(L_cons)(function(){return resolve(L_cons)("pointer-events", "none");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("text-anchor", "middle");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("dominant-baseline", "mathematical");}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("x", function(){return resolve(L_$o)(14, function(){return resolve(L_$f)(L_w, 2);});});}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("y", function(){return resolve(L_$o)(L_border, function(){return resolve(L_$f)(L_h, 2);});});}, function(){return resolve(L_cons)(function(){return resolve(L_cons)("font-weight", "bold");}, L_nil);});});});});});});}, L_nil);});});}, L_nodeW_0, L_nodeH_1, function(){return resolve(L_$f)(L_nodeW_0, 2);}, function(){return resolve(L_$f)(L_nodeH_1, 2);})})()});
  L_$F.leisureFunctionId = 154;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()});
  L_$F.leisureFunctionId = 153;
  L_$F.leisureLength = L_$F.length;
  return L_$F;
})()));
  };
  L_$F.leisureFunctionId = 155;
  L_$F.leisureLength = 2;
  return L_$F;
})()))}
  ]);
});
//# sourceMappingURL=parseAst.map
