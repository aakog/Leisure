"use strict";
define([], function(){
  return L_runMonads([
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("makeNode", 5, "makeNode svg width height rootX rootY = \\f . f svg width height rootX rootY", lazy(setDataType((function(){
  var L$F = function(L_svg, L_width, L_height, L_rootX, L_rootY) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_svg, L_width, L_height, L_rootX, L_rootY),
  Leisure_traceReturn(L$F, (setType((function(){
  var L$F = function(L_f){return (
  Leisure_traceCall(L$F, L_f),
  Leisure_traceReturn(L$F, (resolve(L_f)(L_svg)(L_width)(L_height)(L_rootX)(L_rootY)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})(), 'makeNode')))
);
};;
  L$F.leisureLength = 5;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})(), 'makeNode')));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeSvg", 1, "nodeSvg st = st \\svg width height rootX rootY . svg", lazy((function(){
  var L$F = function(L_st){return (
  Leisure_traceCall(L$F, L_st),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_svg)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeWidth", 1, "nodeWidth st = st \\svg width height rootX rootY . width", lazy((function(){
  var L$F = function(L_st){return (
  Leisure_traceCall(L$F, L_st),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_width)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeHeight", 1, "nodeHeight st = st \\svg width height rootX rootY . height", lazy((function(){
  var L$F = function(L_st){return (
  Leisure_traceCall(L$F, L_st),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_height)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeRootX", 1, "nodeRootX st = st \\svg width height rootX rootY . rootX", lazy((function(){
  var L$F = function(L_st){return (
  Leisure_traceCall(L$F, L_st),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_rootX)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeRootY", 1, "nodeRootY st = st \\svg width height rootX rootY . rootY", lazy((function(){
  var L$F = function(L_st){return (
  Leisure_traceCall(L$F, L_st),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_rootY)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("space", 0, "space = 10", 10);
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("border", 0, "border = 5", 5);
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeTranslate", 3, "nodeTranslate st x y = st \\svg width height rootX rootY . makeNode\r\n  translate svg x y\r\n  width\r\n  height\r\n  rootX + x\r\n  rootY + y", lazy((function(){
  var L$F = function(L_st, L_x, L_y) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_st, L_x, L_y),
  Leisure_traceReturn(L$F, (resolve(L_st)(lazy((function(){
  var L$F = function(L_svg){return (
  Leisure_traceCall(L$F, L_svg),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_width){return (
  Leisure_traceCall(L$F, L_width),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_height){return (
  Leisure_traceCall(L$F, L_height),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootX){return (
  Leisure_traceCall(L$F, L_rootX),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_rootY){return (
  Leisure_traceCall(L$F, L_rootY),
  Leisure_traceReturn(L$F, (resolve(L_makeNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_translate)(L_svg, L_x, L_y));
});
})(++Leisure_traceInstance, L$instance), L_width, L_height, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_rootX, L_x));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_rootY, L_y));
});
})(++Leisure_traceInstance, L$instance))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 4, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 5, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 6, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 7, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 8, L$F.L$instanceId);
  return L$F;
})()))))
);
};;
  L$F.leisureLength = 3;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 9, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeLine", 2, "nodeLine n1 n2 = n1 \\s1 w1 h1 x1 y1 . n2 \\s2 w2 h2 x2 y2 .\r\n  line [['x1'|x1] ['y1'|y1] ['x2'|x2] ['y2'|y2] ['stroke-width'|3] | defaultLineMap]", lazy((function(){
  var L$F = function(L_n1, L_n2) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_n1, L_n2),
  Leisure_traceReturn(L$F, (resolve(L_n1)(lazy((function(){
  var L$F = function(L_s1){return (
  Leisure_traceCall(L$F, L_s1),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_w1){return (
  Leisure_traceCall(L$F, L_w1),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_h1){return (
  Leisure_traceCall(L$F, L_h1),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_x1){return (
  Leisure_traceCall(L$F, L_x1),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_y1){return (
  Leisure_traceCall(L$F, L_y1),
  Leisure_traceReturn(L$F, (resolve(L_n2)(lazy((function(){
  var L$F = function(L_s2){return (
  Leisure_traceCall(L$F, L_s2),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_w2){return (
  Leisure_traceCall(L$F, L_w2),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_h2){return (
  Leisure_traceCall(L$F, L_h2),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_x2){return (
  Leisure_traceCall(L$F, L_x2),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_y2){return (
  Leisure_traceCall(L$F, L_y2),
  Leisure_traceReturn(L$F, (resolve(L_line)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("x1", L_x1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("y1", L_y1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("x2", L_x2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("y2", L_y2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke-width", 3));
});
})(++Leisure_traceInstance, L$instance), L_defaultLineMap));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 11, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 12, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 13, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 14, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 15, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 16, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 17, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 18, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 19, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 20, L$F.L$instanceId);
  return L$F;
})()))))
);
};;
  L$F.leisureLength = 2;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 21, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("rangeContainsRange", 4, "rangeContainsRange start end innerStart innerEnd = and (lte start innerStart) (lte innerEnd end)", lazy((function(){
  var L$F = function(L_start, L_end, L_innerStart, L_innerEnd) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_start, L_end, L_innerStart, L_innerEnd),
  Leisure_traceReturn(L$F, (resolve(L_and)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_lte))(L_start, L_innerStart));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_lte))(L_innerEnd, L_end));
});
})(++Leisure_traceInstance, L$instance))))
);
};;
  L$F.leisureLength = 4;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("highlight", 1, "highlight map = do\r\n  c = assocGetWithDefault 'fill' map nil\r\n  eq c '#fcc'\r\n    assocSet 'fill' 'red' map\r\n    eq c '#cfc'\r\n      assocSet 'fill' 'green' map\r\n      eq c '#ccf'\r\n        assocSet 'fill' 'blue' map\r\n        map", lazy((function(){
  var L$F = function(L_map){return (
  Leisure_traceCall(L$F, L_map),
  Leisure_traceReturn(L$F, ((function(){  var L_c;
  L_c = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_assocGetWithDefault)("fill", L_map, L_nil));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_eq)(L_c, "#fcc")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_assocSet))("fill", "red", L_map));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_c, "#cfc")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_assocSet))("fill", "green", L_map));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_c, "#ccf")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_assocSet))("fill", "blue", L_map));
});
})(++Leisure_traceInstance, L$instance))(L_map));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 7, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("treeFor", 1, "treeFor ast = treeForWith ast \\ast map . map", lazy((function(){
  var L$F = function(L_ast){return (
  Leisure_traceCall(L$F, L_ast),
  Leisure_traceReturn(L$F, (resolve(L_treeForWith)(L_ast, lazy((function(){
  var L$F = function(L_ast_0){return (
  Leisure_traceCall(L$F, L_ast_0),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_map){return (
  Leisure_traceCall(L$F, L_map),
  Leisure_traceReturn(L$F, (resolve(L_map)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("treeForWith", 2, "treeForWith ast mapFunc = nodeSvg (nodeFor ast mapFunc)", lazy((function(){
  var L$F = function(L_ast, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_mapFunc),
  Leisure_traceReturn(L$F, (resolve(L_nodeSvg)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeFor)(L_ast, L_mapFunc));
});
})(++Leisure_traceInstance, L$instance))))
);
};;
  L$F.leisureLength = 2;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("wrappedTreeFor", 1, "wrappedTreeFor ast = do\r\n  content = nodeFor ast \\ast map . map\r\n  svg (nodeSvg content) {'width':(border + (nodeWidth content)) 'height':(border + (nodeHeight content))}", lazy((function(){
  var L$F = function(L_ast){return (
  Leisure_traceCall(L$F, L_ast),
  Leisure_traceReturn(L$F, ((function(){  var L_content;
  L_content = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeFor)(L_ast, lazy((function(){
  var L$F = function(L_ast_0){return (
  Leisure_traceCall(L$F, L_ast_0),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_map){return (
  Leisure_traceCall(L$F, L_map),
  Leisure_traceReturn(L$F, (resolve(L_map)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 1, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_svg)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_content));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 12, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_aconsPair)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("width", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_border, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_content));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 11, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_aconsPair)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("height", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_border, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_content));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 13, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("nodeFor", 2, "nodeFor ast mapFunc = do\r\n  t = getType ast\r\n  eq t 'lit'\r\n    createLitNode ast (show (ast \\v p . v)) mapFunc\r\n    eq t 'ref'\r\n      createRefNode ast (show (ast \\n p . n)) mapFunc\r\n      eq t 'lambda'\r\n        ast (\\v b p . createLambdaNode ast v b mapFunc)\r\n        eq t 'apply'\r\n          ast (\\f a . createApplyNode ast f a mapFunc)\r\n          eq t 'anno'\r\n            #ast (\\n d b . createApplyNode ast f a mapFunc)\r\n            ast (\\n d b . nodeFor b mapFunc)\r\n            log 2 makeNode (svgNode '') 0 0 0 0", lazy((function(){
  var L$F = function(L_ast, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_mapFunc),
  Leisure_traceReturn(L$F, ((function(){  var L_t;
  L_t = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_getType)(L_ast));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_eq)(L_t, "lit")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_createLitNode)(L_ast, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_show)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_ast)(lazy((function(){
  var L$F = function(L_v){return (
  Leisure_traceCall(L$F, L_v),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_p){return (
  Leisure_traceCall(L$F, L_p),
  Leisure_traceReturn(L$F, (resolve(L_v)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 3, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_mapFunc));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 28, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_t, "ref")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 11, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_createRefNode)(L_ast, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_show)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_ast)(lazy((function(){
  var L$F = function(L_n){return (
  Leisure_traceCall(L$F, L_n),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_p){return (
  Leisure_traceCall(L$F, L_p),
  Leisure_traceReturn(L$F, (resolve(L_n)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 7, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 8, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_mapFunc));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 27, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_t, "lambda")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 15, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_ast)(lazy((function(){
  var L$F = function(L_v){return (
  Leisure_traceCall(L$F, L_v),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_b){return (
  Leisure_traceCall(L$F, L_b),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_p){return (
  Leisure_traceCall(L$F, L_p),
  Leisure_traceReturn(L$F, (resolve(L_createLambdaNode)(L_ast, L_v, L_b, L_mapFunc)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 12, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 13, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 14, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 26, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_t, "apply")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 18, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_ast)(lazy((function(){
  var L$F = function(L_f){return (
  Leisure_traceCall(L$F, L_f),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_a){return (
  Leisure_traceCall(L$F, L_a),
  Leisure_traceReturn(L$F, (resolve(L_createApplyNode)(L_ast, L_f, L_a, L_mapFunc)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 16, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 17, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 25, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_eq)(L_t, "anno")((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 22, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_ast)(lazy((function(){
  var L$F = function(L_n){return (
  Leisure_traceCall(L$F, L_n),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_d){return (
  Leisure_traceCall(L$F, L_d),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_b){return (
  Leisure_traceCall(L$F, L_b),
  Leisure_traceReturn(L$F, (resolve(L_nodeFor)(L_b, L_mapFunc)))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 19, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 20, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 21, L$F.L$instanceId);
  return L$F;
})())));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 24, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_log)(2, L_makeNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 23, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_svgNode)(""));
});
})(++Leisure_traceInstance, L$instance))(0)(0)(0)(0));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))})()))
);
};;
  L$F.leisureLength = 2;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 29, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("redStyle", 0, "redStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#fcc'] ['rx'|8] ['ry'|8]]", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke", "black"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke-width", 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("fill", "#fcc"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("rx", 8));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("ry", 8));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("greenStyle", 0, "greenStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#cfc'] ['rx'|8] ['ry'|8]]", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke", "black"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke-width", 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("fill", "#cfc"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("rx", 8));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("ry", 8));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("blueStyle", 0, "blueStyle = [['stroke'|'black'] ['stroke-width'|2] ['fill'|'#ccf'] ['rx'|8] ['ry'|8]]", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke", "black"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("stroke-width", 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("fill", "#ccf"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("rx", 8));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("ry", 8));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("createLambdaNode", 4, "createLambdaNode ast v b mapFunc = do\r\n  rootBox = textNode (mapFunc ast greenStyle) 'lambda'\r\n  varBox = textNode (mapFunc ast greenStyle) v\r\n  bodyTree = nodeFor b mapFunc\r\n  childWidth = (nodeWidth varBox) + space + (nodeWidth bodyTree)\r\n  totalWidth = max childWidth (nodeWidth rootBox)\r\n  pad = max 0 (totalWidth - childWidth) / 2\r\n  rootBox = nodeTranslate rootBox (totalWidth / 2 - (nodeWidth rootBox) / 2) 0\r\n  varBox = nodeTranslate varBox pad (nodeHeight rootBox) + space\r\n  bodyTree = nodeTranslate bodyTree (pad + (nodeWidth varBox) + space) ((nodeHeight rootBox) + space)\r\n  log 3 makeNode\r\n    svgConcat [(nodeLine rootBox varBox) (nodeLine rootBox bodyTree) (nodeSvg varBox) (nodeSvg bodyTree) (nodeSvg rootBox)]\r\n    totalWidth\r\n    (nodeHeight rootBox) + space + (max (nodeHeight varBox) (nodeHeight bodyTree))\r\n    totalWidth / 2\r\n    (nodeHeight rootBox) / 2", lazy((function(){
  var L$F = function(L_ast, L_v, L_b, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_v, L_b, L_mapFunc),
  Leisure_traceReturn(L$F, ((function(){  var L_rootBox, L_varBox, L_bodyTree, L_childWidth, L_totalWidth, L_pad, L_rootBox_0, L_varBox_1, L_bodyTree_2;
  L_rootBox = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_textNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_mapFunc))(L_ast, L_greenStyle));
});
})(++Leisure_traceInstance, L$instance), "lambda"));
});
})(++Leisure_traceInstance, L$instance);
  L_varBox = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_textNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_mapFunc))(L_ast, L_greenStyle));
});
})(++Leisure_traceInstance, L$instance), L_v));
});
})(++Leisure_traceInstance, L$instance);
  L_bodyTree = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeFor)(L_b, L_mapFunc));
});
})(++Leisure_traceInstance, L$instance);
  L_childWidth = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_varBox));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_bodyTree));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_totalWidth = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 11, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)(L_childWidth, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_rootBox));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_pad = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 14, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)(0, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 13, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 12, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$_)(L_totalWidth, L_childWidth));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_rootBox_0 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 19, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_rootBox, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 18, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$_)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 15, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_totalWidth, 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 17, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 16, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_rootBox));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), 0));
});
})(++Leisure_traceInstance, L$instance);
  L_varBox_1 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 22, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_varBox, L_pad, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 21, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 20, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_bodyTree_2 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 28, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_bodyTree, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 25, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 24, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_pad, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 23, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_varBox_1));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 27, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 26, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_log)(3, L_makeNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 39, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_svgConcat)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 38, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 29, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeLine)(L_rootBox_0, L_varBox_1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 37, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 30, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeLine)(L_rootBox_0, L_bodyTree_2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 36, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 31, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_varBox_1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 35, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 32, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_bodyTree_2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 34, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 33, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))(L_totalWidth)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 45, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 41, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 40, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 44, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 42, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_varBox_1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 43, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_bodyTree_2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 46, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_totalWidth, 2));
});
})(++Leisure_traceInstance, L$instance))((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 48, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 47, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance))})()))
);
};;
  L$F.leisureLength = 4;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 49, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("createApplyNode", 4, "createApplyNode ast f a mapFunc = do\r\n  rootBox = textNode (mapFunc ast blueStyle) 'apply'\r\n  funcTree = nodeFor f mapFunc\r\n  argTree = nodeFor a mapFunc\r\n  childWidth = (nodeWidth argTree) + space + (nodeWidth funcTree)\r\n  totalWidth = max childWidth (nodeWidth rootBox)\r\n  pad = max 0 (totalWidth - childWidth) / 2\r\n  rootBox = nodeTranslate rootBox (totalWidth / 2 - (nodeWidth rootBox) / 2) 0\r\n  funcTree = nodeTranslate funcTree pad (nodeHeight rootBox) + space\r\n  argTree = nodeTranslate argTree (pad + (nodeWidth funcTree) + space) ((nodeHeight rootBox) + space)\r\n  makeNode\r\n    svgConcat [(nodeLine rootBox funcTree) (nodeLine rootBox argTree) (nodeSvg rootBox) (nodeSvg funcTree) (nodeSvg argTree)]\r\n    totalWidth\r\n    (nodeHeight rootBox) + space + (max (nodeHeight argTree) (nodeHeight funcTree))\r\n    totalWidth / 2\r\n    (nodeHeight rootBox) / 2", lazy((function(){
  var L$F = function(L_ast, L_f, L_a, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_f, L_a, L_mapFunc),
  Leisure_traceReturn(L$F, ((function(){  var L_rootBox, L_funcTree, L_argTree, L_childWidth, L_totalWidth, L_pad, L_rootBox_0, L_funcTree_1, L_argTree_2;
  L_rootBox = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_textNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_mapFunc))(L_ast, L_blueStyle));
});
})(++Leisure_traceInstance, L$instance), "apply"));
});
})(++Leisure_traceInstance, L$instance);
  L_funcTree = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeFor)(L_f, L_mapFunc));
});
})(++Leisure_traceInstance, L$instance);
  L_argTree = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeFor)(L_a, L_mapFunc));
});
})(++Leisure_traceInstance, L$instance);
  L_childWidth = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_argTree));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_funcTree));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_totalWidth = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)(L_childWidth, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_rootBox));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_pad = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 13, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)(0, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 12, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 11, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$_)(L_totalWidth, L_childWidth));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_rootBox_0 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 18, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_rootBox, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 17, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$_)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 14, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_totalWidth, 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 16, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 15, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_rootBox));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), 0));
});
})(++Leisure_traceInstance, L$instance);
  L_funcTree_1 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 21, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_funcTree, L_pad, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 20, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 19, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);
  L_argTree_2 = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 27, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeTranslate)(L_argTree, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 24, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 23, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_pad, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 22, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeWidth)(L_funcTree_1));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 26, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 25, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_makeNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 38, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_svgConcat)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 37, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 28, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeLine)(L_rootBox_0, L_funcTree_1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 36, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 29, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeLine)(L_rootBox_0, L_argTree_2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 35, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 30, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 34, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 31, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_funcTree_1));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 33, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 32, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeSvg)(L_argTree_2));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_totalWidth, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 44, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 40, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 39, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), L_space));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 43, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_max)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 41, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_argTree_2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 42, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_funcTree_1));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 45, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_totalWidth, 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 47, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 46, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_nodeHeight)(L_rootBox_0));
});
})(++Leisure_traceInstance, L$instance), 2));
});
})(++Leisure_traceInstance, L$instance))})()))
);
};;
  L$F.leisureLength = 4;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 48, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("createRefNode", 3, "createRefNode ast ref mapFunc = textNode (mapFunc ast redStyle) ref", lazy((function(){
  var L$F = function(L_ast, L_ref, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_ref, L_mapFunc),
  Leisure_traceReturn(L$F, (resolve(L_textNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_mapFunc))(L_ast, L_redStyle));
});
})(++Leisure_traceInstance, L$instance), L_ref)))
);
};;
  L$F.leisureLength = 3;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("createLitNode", 3, "createLitNode ast lit mapFunc = textNode (mapFunc ast greenStyle) lit", lazy((function(){
  var L$F = function(L_ast, L_lit, L_mapFunc) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_ast, L_lit, L_mapFunc),
  Leisure_traceReturn(L$F, (resolve(L_textNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(L$(resolve(L_mapFunc))(L_ast, L_greenStyle));
});
})(++Leisure_traceInstance, L$instance), L_lit)))
);
};;
  L$F.leisureLength = 3;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 2, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)},
    function(){return (function(L$context, L$instance){
  var L$ret;
  Leisure_traceTopLevel(L$context);
  return resolve(L_newDefine)("textNode", 2, "textNode map txt = (svgMeasureText txt '') \\w h . do\r\n  nodeW = w + 24\r\n  nodeH = h + 14\r\n  makeNode\r\n    (svgConcat [(rect [['x'|2] ['y'|2] ['width'|nodeW] ['height'|nodeH] | map]) (text txt [['pointer-events' | 'none'] ['text-anchor'|\"middle\"] ['dominant-baseline'|\"mathematical\"] ['x'| 14 + w / 2] ['y'| border + h / 2] ['font-weight'|'bold']])])\r\n    nodeW\r\n    nodeH\r\n    nodeW / 2\r\n    nodeH / 2", lazy((function(){
  var L$F = function(L_map, L_txt) {
  return L_checkPartial(L$F, arguments) || (
  Leisure_traceCall(L$F, L_map, L_txt),
  Leisure_traceReturn(L$F, (L$(resolve(L_svgMeasureText))(L_txt, "", lazy((function(){
  var L$F = function(L_w){return (
  Leisure_traceCall(L$F, L_w),
  Leisure_traceReturn(L$F, ((function(){
  var L$F = function(L_h){return (
  Leisure_traceCall(L$F, L_h),
  Leisure_traceReturn(L$F, ((function(){  var L_nodeW, L_nodeH;
  L_nodeW = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 1, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_w, 24));
});
})(++Leisure_traceInstance, L$instance);
  L_nodeH = (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 2, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_h, 14));
});
})(++Leisure_traceInstance, L$instance);

  return resolve(L_makeNode)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 31, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_svgConcat)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 30, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 11, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_rect)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 10, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 3, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("x", 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 9, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 4, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("y", 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 8, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 5, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("width", L_nodeW));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 7, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 6, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("height", L_nodeH));
});
})(++Leisure_traceInstance, L$instance), L_map));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 29, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 28, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_text)(L_txt, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 27, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 12, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("pointer-events", "none"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 26, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 13, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("text-anchor", "middle"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 25, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 14, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("dominant-baseline", "mathematical"));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 24, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 17, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("x", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 16, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(14, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 15, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_w, 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 23, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 20, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("y", (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 19, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$o)(L_border, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 18, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_h, 2));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 22, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)((function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 21, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_cons)("font-weight", "bold"));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_nil));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance)));
});
})(++Leisure_traceInstance, L$instance), L_nodeW, L_nodeH, (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 32, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_nodeW, 2));
});
})(++Leisure_traceInstance, L$instance), (function(L$instance, L$parentInstance){
  return Leisure_traceLazyValue(L$context, 33, L$instance, L$parentInstance, function(){
  return Leisure_traceResolve(resolve(L_$f)(L_nodeH, 2));
});
})(++Leisure_traceInstance, L$instance))})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 34, L$F.L$instanceId);
  return L$F;
})()))
);};
  L$F.leisureLength = L$F.length;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 35, L$F.L$instanceId);
  return L$F;
})()))))
);
};;
  L$F.leisureLength = 2;
  L$F.L$instanceId = ++Leisure_traceInstance;
  Leisure_traceLambda(L$F, L$context, 36, L$F.L$instanceId);
  return L$F;
})()));
})(++Leisure_traceContext, ++Leisure_traceInstance)}
  ]);
});
//# sourceMappingURL=parseAst.map
