{
  "version": 3,
  "file": "docOrg.js",
  "sourceRoot": "..",
  "sources": [
    "src/docOrg.litcoffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "    'use strict'\n    define ['./org', 'lib/js-yaml', 'lib/lazy'], (Org, Yaml, Lazy)->\n\n      {\n        Headline\n        Source\n        HTML\n        Keyword\n        Drawer\n        Meat\n        UnknownDeclaration\n        Results\n        parseOrgMode\n        Fragment\n      } = Org\n\n      {\n        safeLoad\n        load\n        dump\n      } = Yaml\n\n      {_: _L} = Lazy\n\n      class ParsedCodeBlock\n        constructor: (block)-> if typeof block == 'string' then @setBlockText block else @init block\n        clone: -> new ParsedCodeBlock @block\n        getOrg: -> blockOrg @block\n        toString: -> \"Parsed:\\n  #{@block.text.replace(/\\n/g, '\\n  ')}\"\n        init: (@block)->\n          org = blockOrg @block\n          if org instanceof Fragment || org instanceof Headline then org = org.children[0]\n          @items = getCodeItems org\n        setBlockText: (str)->\n          if (bl = orgDoc parseOrgMode str.replace /\\r\\n/g, '\\n').length != 1 || bl[0].text != str\n            throw new Error \"Bad code block: '#{str}'\"\n          bl[0]._id = @block?._id\n          @init bl[0]\n        spliceItem: (itemName, str)->\n          if str && _.last(str) != '\\n' then str += '\\n'\n          item = @items[itemName]\n          @setBlockText if item then @block.text.substring(0, item.offset) + str + @block.text.substring(item.offset + item.text.length)\n          else @block.text + \"#+#{itemName.toUpperCase()}:\\n#{str}\"\n        setCodeInfo: (info)->\n          {text} = @block\n          {source} = @items\n          infoStart = source.offset + source.infoPos\n          @setBlockText text.substring(0, infoStart) + info + text.substring infoStart + source.info.length\n        setCodeAttribute: (name, value)->\n          info = @items.source.info ? ''\n          @setCodeInfo if @block.codeAttributes?[name.toLowerCase()]?\n            m = info.match new RegExp \"^((|.*\\\\S)(\\\\s*))(:#{escapeRegexp name})((\\\\s+[^:]*)?(?=:|$))\", 'i'\n            prefix = m.index + m[1].length + m[4].length\n            suffix = info.substring prefix + m[5].length\n            if suffix then suffix = ' ' + suffix\n            if !value? then info.substring(0, m.index + m[2].length) + suffix\n            else info.substring(0, prefix) + ' ' + value + suffix\n          else if !value? then info\n          else info + \" :#{name}\" + (if value then ' ' + value else '')\n        setResults: (str)-> @spliceItem 'results', str\n        setSource: (str)-> @spliceItem 'source', str\n        setError: (str)-> @spliceItem 'error', str\n        addResultType: (str)->\n          types = @getResultTypes()\n          if !(str in types)\n            results = @block.codeAttributes?.results\n            @setCodeAttribute 'results', if results then \"#{results} #{str}\" else str\n        removeResultType: (str)->\n          res = @block.codeAttributes?.results\n          types = @getResultTypes()\n          if str.toLowerCase() in types\n            values = res.toLowerCase().split /(\\s+)/\n            start = values.indexOf str.toLowerCase()\n            end = start + 1\n            if start > 0 then start--\n            else if end < values.length then end++\n            prefix = 0\n            for i in [0...start]\n              prefix += values[i].length\n            len = 0\n            for i in [start...end]\n              len += values[i].length\n              values[i] = false\n            @setCodeAttribute 'results', if _.some values\n              res.substring(0, prefix) + res.substring(prefix + len)\n        setResultView: (viewStr)->\n          if viewStr then viewStr = ' ' + viewStr\n          res = @block.codeAttributes?.results\n          newRes = if m = res.match /\\s*\\bview(\\(.*\\)|\\b)/\n            res.substring(0, m.index) + viewStr + res.substring(m.index + m[0].length)\n          else if viewStr then res + viewStr\n          else res\n          @setCodeAttribute 'results', newRes\n        setExports: (code, results)->\n          @setCodeAttribute 'exports', if !code || !results then (code && 'code') || (results && 'results') || 'none'\n        exportsCode: -> @getExports() in ['code', 'both']\n        exportsResults: ->  @getExports() in ['results', 'both']\n        getExports: -> @block.codeAttributes?.exports?.toLowerCase() || 'both'\n        getResultTypes: -> @block.codeAttributes?.results?.toLowerCase().split(' ') ? []\n        setDynamic: (state)->\n          if @isDynamic() != state\n            if state then @addResultType 'dynamic'\n            else @removeResultType 'dynamic'\n        isDynamic: -> 'dynamic' in @getResultTypes()\n        setSourceContent: (newContent)->\n          src = @items.source\n          @setSource \"#{src.text.substring 0, src.contentPos}#{newContent}#{src.text.substring src.contentPos + src.content.length}\"\n        hasExpected: -> @items.expected\n        resultsAreExpected: ->\n          @items.expected && @items.results && @items.expected.content() == @items.results.content()\n        makeResultsExpected: ->\n          if @items.results\n            newExpected = \":expected:\\n#{@items.results.content()}:end:\\n\"\n            item = @items.expected\n            @setBlockText if item then @block.text.substring(0, item.offset) + newExpected + @block.text.substring(item.offset + item.text.length)\n            else\n              source = @items.source\n              @block.text.substring(0, source.offset + source.text.length) + newExpected + @block.text.substring(source.offset + source.text.length)\n        clearExpected: ->\n          if item = @items.expected\n            @setBlockText @block.text.substring(0, item.offset) + @block.text.substring(item.offset + item.text.length)\n\n      escapeRegexp = (str)-> str.replace /[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&'\n\n      blockOrg = (block)->\n        text = if typeof block == 'string' then block else block.text\n        org = parseOrgMode text\n        org = if org.children.length == 1 then org.children[0]\n        else\n          frag = new Fragment org.offset, org.children\n          frag\n        if typeof block == 'object'\n          org.nodeId = block._id\n          org.shared = block.type\n        org.linkNodes()\n        org\n\n      getCodeItems = (org)->\n        if !getSourceNodeType org then {}\n        else\n          result = {}\n          while !isSourceEnd org\n            if type = getSourceNodeType org\n              if type == 'html'\n                return if result.first then result\n                else source: org, first: org, last: org\n              if !result.first then result.first = org\n              else if type == 'name' then return result\n              if result[type]? then return result\n              result.last = result[type] = org\n              if type == 'name' && org.next.constructor == Meat && org.next.next instanceof Source then result.doc = org.next\n              if type == 'results' then break\n            else if org instanceof Drawer || org instanceof Keyword || org instanceof UnknownDeclaration then break\n            org = org.next\n          if result.source then result else {}\n\n      isCodeBlock = (org)->\n        if org instanceof Keyword && org.name.match /^name$/i\n          {first} = getCodeItems org\n          first\n        else org instanceof Source\n\n      getSourceNodeType = (org)->\n        if org instanceof Source then 'source'\n        else if org instanceof HTML then 'html'\n        else if org instanceof Results then 'results'\n        else if org instanceof Drawer && org.name.toLowerCase() == 'expected' then 'expected'\n        else if org instanceof Keyword && org.name.match /^name$/i then 'name'\n        else if org instanceof Keyword && org.name.match /^error$/i then 'error'\n        else false\n\n      isSourceEnd = (org)-> !org || org instanceof Headline\n\n      createDocFromOrg = (org, collection, reloading, filter)->\n        doc = orgDoc org\n        if filter? then doc = _.map doc, filter\n        replaceOrgDoc doc, collection, reloading\n        collection\n\n      docRoot = (collection)->\n        (collection.leisure ? collection.leisure = {}).info ? (collection.leisure.info = collection.findOne info: true)\n\n      replaceOrgDoc = (docArray, collection, reloading)->\n        if reloading then collection.remove info: ('$exists': false)\n        else collection.remove()\n        linkDocs docArray\n        #console.log \"DOCS: #{JSON.stringify docArray, null, '  '}\"\n        if reloading\n          info = collection.leisure.info\n          info.head = if docArray.length > 0 then docArray[0]._id else null\n          collection.update info._id, info\n        else\n          info = collection.leisure.info =\n            info: true\n            head: if docArray.length > 0 then docArray[0]._id else null\n            _id: new Meteor.Collection.ObjectID().toJSONValue()\n          collection.insert info\n        for doc in docArray\n          collection.insert doc\n\n      linkDocs = (docs)->\n        prev = null\n        for doc in docs\n          doc._id = new Meteor.Collection.ObjectID().toJSONValue()\n          if prev\n            prev.next = doc._id\n            doc.prev = prev._id\n          prev = doc\n\n      orgDoc = (org, withProperties)-> createOrgDoc(org, false, withProperties)[0].toArray()\n\n      lineCodeBlockType = (line)->\n        type = line && root.matchLine line\n        if type in ['srcStart', 'srcEnd', 'htmlStart', 'htmlEnd'] then 'code'\n        else if line.match /^#+name:/i then 'code'\n        else if type == 'headline-1' then 'headline'\n        else 'chunk'\n\n      createOrgDoc = (org, local, withProps)->\n        next = org.next\n        if org instanceof Headline\n          local = local || (org.level == 1 && org.properties.local)\n          children = createChildrenDocs org, local, withProps\n          result = if org.level == 0 then (org.children.length && children) || _L([text: '\\n', type: 'chunk', offset: org.offset])\n          else\n            _L([text: org.text, type: 'headline', level: org.level, offset: org.offset, properties: org.properties]).concat children\n        else if org instanceof HTML then [result, next] = createHtmlBlockDoc org\n        else if isCodeBlock org then [result, next] = createCodeBlockDoc org\n        else\n          block = text: org.allText(), type: 'chunk', offset: org.offset\n          if title = findTitle org then block.title = title\n          result = _L(checkProps org, [block])\n        block = result.last()\n        if withProps && block.type == 'code'\n          block.properties = org.allProperties()\n        if local then result.each (item)-> item.local = true\n        [result, next]\n\n      findTitle = (org)->\n        if org instanceof Keyword && org.name.toLowerCase() == 'title'\n          return org.info.trim()\n        else if org.children\n          for child in org.children when title = findTitle child\n            return title\n\n      checkProps = (org, block)->\n        if org.isProperties?()\n          block.properties = org.properties()\n\n      createChildrenDocs = (org, local, withProps)->\n        children = _L()\n        child = org.children[0]\n        title = null\n        if child\n          mergedText = ''\n          properties = _L()\n          offset = org.children[0].offset\n          while child\n            if newTitle = findTitle child then title = newTitle\n            if isMergeable child\n              mergedText += child.allText()\n              if child.properties?() then properties = properties.merge child.properties?()\n              child = child.next\n            else\n              [mergedText, properties, children] = checkMerged mergedText, properties, children, offset\n              [childDoc, child] = createOrgDoc child, local, withProps\n              if title\n                (if children.isEmpty() then childDoc else children).first().title = title\n                title = null\n              children = children.concat [childDoc]\n              offset = child?.offset\n          [mergedText, properties, children] = checkMerged mergedText, properties, children, offset, title\n        children\n\n      isMergeable = (org)-> !(org instanceof Headline || org instanceof HTML || isCodeBlock org)\n\n      checkMerged = (mergedText, properties, children, offset, title)->\n        if mergedText != ''\n          child = text: mergedText, type: 'chunk', offset: offset\n          if title then child.title = title\n          if !properties.isEmpty() then child.properties = properties.toObject()\n          children = children.concat [child]\n        ['', _L(), children]\n\n      createCodeBlockDoc = (org)->\n        text = ''\n        {first, name, source, last, expected, results} = getCodeItems org\n        if !first then [_L([text: org.allText(), type: 'chunk', offset: org.offset]), org.next]\n        else\n          firstOffset = first.offset\n          while first != last.next\n            text += first.allText()\n            first = first.next\n          obj = text: text, type: 'code', offset: firstOffset\n          if source.attributes()\n            attr = {}\n            for nm, val of source.attributes()\n              attr[nm.toLowerCase()] = val\n          else attr = null\n          obj.codeAttributes = attr\n          obj.codePrelen = source.contentPos + source.offset - firstOffset\n          obj.codePostlen = text.length - obj.codePrelen - source.content.length\n          if expected\n            obj.codeContent = source.content\n            obj.codeTestActual = results.content()\n            obj.codeTestExpected = expected.content()\n            obj.codeTestResult = if !results then 'unknown'\n            else if expected.content() == results.content() then 'pass'\n            else 'fail'\n          if name then obj.codeName = name.info.trim()\n          if obj.codeAttributes?.local? then obj.local = true\n          if l = source.lead() then obj.language = l.trim()\n          if isYamlResult(obj) || isYaml source\n            yamlSrc = (if isYaml(source) && !results then source.content\n            else\n              obj.computedYaml = true\n              results?.content().replace /^: /gm, '')\n            if yamlSrc then obj.yaml = parseYaml yamlSrc\n          else if isText source then obj.yaml = source.content\n          [_L([obj]), last.next]\n\n      parseYaml = (str)->\n        try\n          #safeLoad str\n          load str\n        catch err\n          undefined\n\n      createHtmlBlockDoc = (org)->\n          text = org.allText()\n          obj = text: text, type: 'code', offset: org.offset\n          obj.codePrelen = org.contentPos\n          obj.codePostlen = text.length - obj.codePrelen - org.contentLength\n          obj.language = 'html'\n          if a = org.attributes() then obj.codeAttributes = a\n          [_L([obj]), org.next]\n\n      isYaml = (org)-> org instanceof Source && org.info.match /^ *yaml\\b/i\n\n      isYamlResult = (block)-> block.codeAttributes?.results?.match(/\\byaml\\b/) || block.codeAttributes?.post\n\n      isText = (org)-> org instanceof Source && org.info.match /^ *(text|string)\\b/i\n\n      checkSingleNode = (text)->\n        docs = {}\n        org = parseOrgMode text\n        [docJson] = if org.children.length > 1 then orgDoc org\n        else orgDoc org.children[0]\n        #if docJson.children? then console.log \"NEW NODE\\n#{JSON.stringify docJson}\"\n        docJson\n\n      crnl = (data)->\n        if typeof data == 'string' then data.replace /\\r\\n/g, '\\n'\n        else if data.text\n          data.text = crnl data.text\n          data\n        else data\n\n      blockSource = (block)->\n        block && block.text.substring block.codePrelen, block.text.length - block.codePostlen\n\n      {\n        getCodeItems\n        isCodeBlock\n        createDocFromOrg\n        checkSingleNode\n        orgDoc\n        docRoot\n        linkDocs\n        isYaml\n        isText\n        crnl\n        lineCodeBlockType\n        blockSource\n        ParsedCodeBlock\n        blockOrg\n        parseYaml\n      }\n"
  ]
}